<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ジャンプ付きWASDゲーム</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #222;
    }
    #gameArea {
      position: relative;
      width: 800px;
      height: 600px;
      margin: 30px auto;
      background: #444;
      border: 3px solid #fff;
      user-select: none;
    }
    #player {
      position: absolute;
      width: 40px;
      height: 40px;
      background: #0f0;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div id="gameArea">
    <div id="player"></div>
  </div>

  <script>
    const player = document.getElementById("player");
    const gameArea = document.getElementById("gameArea");
    const speed = 5;
    const gravity = 0.7;
    const jumpPower = 15;

    const keys = { w: false, a: false, s: false, d: false };

    // 初期位置（数値で設定）
    let posX = 380;
    let posY = 560;
    let velocityY = 0;

    const playerWidth = 40;
    const playerHeight = 40;
    const groundY = gameArea.clientHeight - playerHeight;

    // キー入力処理
    window.addEventListener("keydown", (e) => {
      const key = e.key.toLowerCase();
      if (keys.hasOwnProperty(key)) keys[key] = true;
    });

    window.addEventListener("keyup", (e) => {
      const key = e.key.toLowerCase();
      if (keys.hasOwnProperty(key)) keys[key] = false;
    });

    function update() {
      // 横移動
      if (keys.a) posX -= speed;
      if (keys.d) posX += speed;

      // ジャンプ
      if (keys.w && posY >= groundY) {
        velocityY = -jumpPower;
      }

      // 重力
      velocityY += gravity;
      posY += velocityY;

      // 地面判定
      if (posY > groundY) {
        posY = groundY;
        velocityY = 0;
      }

      // 左右の壁判定
      posX = Math.min(Math.max(posX, 0), gameArea.clientWidth - playerWidth);

      // 位置更新
      player.style.left = posX + "px";
      player.style.top = posY + "px";

      requestAnimationFrame(update);
    }

    update();
  </script>
</body>
</html>
